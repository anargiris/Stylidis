---
title: Set up auth/authorization with NextJS app router and Supabase
date: 10 February 2024
description: My first blog is a guide on getting auth up and running in a short time using NextJS and Supabase.
---

<img src="/blog_post_headers/1.jpg" className="w-full h-[400px] mb-5" />

# Setting up Authentication/Authorization in NextJS app router with Supabase

### Intro

I took the time to write this blog to help people &#40;and myself in the
future&#41; setting up auth/authorization in their NextJS/Supabase projects.

After the NextJS transition to the [app router](https://nextjs.org/docs/app), the paradigm shift has left a
lot of people wondering on how to do things correctly. React Server
Components, "use client" and the damned hydration errors among others made a
lot of devs wonder if they should transition to other solutions
&#40;Sveltekit, HTMX&#40;!!&#41;, Vue, Angular&#41;.

For the sake of this tutorial, I am assuming you already have a NextJS project
set up together with a Supabase instance. If you don't, here are some links to
help you get started:

**NextJS Getting started:** [Link](https://nextjs.org/learn-pages-router/basics/create-nextjs-app/setup)

**Supabase Getting started:** [Link](https://supabase.com/docs/guides/getting-started)

### Setting up

The Supabase team has been fast in adapting to the app router and created the new <SmallCodeBlock content={"@supabase-ssr"} /> package migrating from their older <SmallCodeBlock content={"@auth-helpers"} />. So let's get started!

Open the terminal in your application and type:
<CodeBlock>
```bash
npm install @supabase/ssr @supabase/supabase-js
```
</CodeBlock>
This will install the dependencies we are going to use for our example.

On the root of you application create a <SmallCodeBlock content={"utils"} /> folder and inside of it create a <SmallCodeBlock content={"supabase"} /> folder. We will then create the files we will need inside. Create the following 3 files inside the supabase folder:
- client.js
- server.js
- middleware.js

This will help us create Supabase clients to use in the server or the client depending on our needs. We will also create a middleware that runs between pages in the server to refresh the user token and protect specific pages of our app. Thankfully the packages we installed earlier provide helpful functions to make our implementation easier.

If you haven&apos;t already, get the Supabase environmental variables and put them in your project env files. In your Supabase dashboard, locate the Settings page and then click on the "API" section under the Configuration list.

Your .env.local file should look something like this:
<CodeBlock>
```javascript
NEXT_PUBLIC_SUPABASE_URL=***YOUR_SUPABASE_DB_URL***
NEXT_PUBLIC_SUPABASE_ANON_KEY=***YOUR_SUPABASE_ANON_KEY***
```
 </CodeBlock>

 Let&apos;s get started implementing the code in our files!

 ### client.js

 This will be used when we need to connect to our Supabase database from client components.
<CodeBlock>
```javascript
import { createBrowserClient } from "@supabase/ssr";

export const createClient = () =>
  createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY
  );

```
</CodeBlock>
